% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/blocksVcf.R
\name{blocksVcf}
\alias{blocksVcf}
\title{Collapse contiguous variants with the same inferred state into blocks}
\usage{
blocksVcf(df)
}
\arguments{
\item{df}{A \code{data.frame} produced by \code{asDfVcf()}, containing at
least the columns \code{seqnames}, \code{start}, \code{end},
\code{group}, and \code{geno_coded}. Optionally may include depth/quality
metrics for the trio (\code{quality_proband}, \code{quality_mother},
\code{quality_father}).}
}
\value{
A \code{data.frame} with one row per block. Columns include:
\itemize{
\item \code{ID} – sample identifier
\item \code{seqnames}, \code{start}, \code{end} – genomic coordinates
\item \code{group} – inferred state of the block
\item \code{n_snps} – number of variants in the block
\item \code{geno_coded} – list of numeric genotype codes per block
\item summed and counted quality/depth metrics per block (if present)
}
}
\description{
This internal helper function identifies consecutive variants in a data.frame
(produced by \code{asDfVcf()}) that share the same inferred state (\code{group})
and merges them into contiguous "blocks". Each block summarizes its start
and end positions, the number of variants it contains, genotype codings, and
optionally summed quality or depth metrics.
}
\details{
The function performs the following steps:
\enumerate{
\item Uses run-length encoding to detect contiguous variants with identical
states.
\item Summarizes each block with:
\itemize{
\item \code{seqnames}, \code{start}, \code{end}
\item \code{group}: the inferred state
\item \code{n_snps}: number of variants in the block
\item \code{geno_coded}: a list of numeric genotype codes for the block
}
\item Optionally computes per-block sums and counts for trio depth/quality
metrics if the columns exist in the input.
}
}
