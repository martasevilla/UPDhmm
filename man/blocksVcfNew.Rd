% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/blocksVcfNew.r
\name{blocksVcfNew}
\alias{blocksVcfNew}
\title{Collapse contiguous variants into genomic blocks based on HMM states}
\usage{
blocksVcfNew(
  largeCollapsedVcf,
  add_ratios = FALSE,
  field_DP = NULL,
  total_mean = NULL,
  ratio_cols = c("ratio_proband", "ratio_mother", "ratio_father")
)
}
\arguments{
\item{largeCollapsedVcf}{A \code{CollapsedVCF} containing \code{states} and \code{geno_coded} in \code{mcols()}.}

\item{add_ratios}{Logical; if \code{TRUE}, per-block ratios are computed and added to the output.}

\item{field_DP}{Optional character specifying the FORMAT depth field to use (e.g., \code{"DP"} or \code{"AD"}). Auto-selected if \code{NULL}.}

\item{total_mean}{Optional numeric vector containing chromosome-wide mean depth per sample, used to compute ratios.}

\item{ratio_cols}{Character vector of column names to assign to the ratio output when \code{total_mean} is provided.}
}
\value{
A \code{data.frame} with one row per block, containing chromosome, start, end, HMM state, number of SNPs,
genotype encodings, and optionally per-block ratios relative to \code{total_mean}.
}
\description{
This function creates block-level representations from a \code{CollapsedVCF}.
It performs the following steps:
\enumerate{
\item Identifies consecutive variants sharing the same inferred HMM state (\code{states}) and groups them into blocks.
\item Extracts genomic coordinates, number of variants, HMM state, and genotype encodings (\code{geno_coded}) for each block.
\item Optionally computes per-block depth ratios relative to a chromosome-wide mean (\code{total_mean}) from a specified FORMAT field (e.g., \code{DP} or \code{AD}) if provided.
}
}
