% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/processChromosome.R
\name{processChromosome}
\alias{processChromosome}
\title{Process a single chromosome for UPD detection}
\usage{
processChromosome(
  vcf_chr,
  hmm,
  add_ratios = FALSE,
  field_DP = NULL,
  total_mean = NULL,
  mendelian_error_values
)
}
\arguments{
\item{vcf_chr}{A CollapsedVCF object representing a single chromosome.}

\item{hmm}{A Hidden Markov Model object.}

\item{add_ratios}{Logical; default = FALSE.

If TRUE, computes normalized per-block read depth ratios for each individual based on total mean depth.}

\item{field_DP}{Optional character string specifying which VCF FORMAT field to use for depth metrics (e.g., DP, AD, or a custom field).}

\item{total_mean}{Optional numeric vector of per-sample mean read depths across the entire VCF, used to normalize per-block depth ratios computed via \code{computeTrioTotals()} in \code{calculateEvents()}.}

\item{mendelian_error_values}{Character vector of genotype codes considered
Mendelian errors (i.e., observations with minimal emission probability in
the "normal" state).
Provided by \code{calculateEvents()}.}
}
\value{
A data.frame summarizing blocks detected on the chromosome. Columns include:
\itemize{
\item \code{seqnames} – chromosome name
\item \code{start}, \code{end} – genomic coordinates of the block
\item \code{group} – inferred HMM state
\item \code{n_snps} – number of SNPs in the block
\item \code{n_mendelian_error} – number of Mendelian-inconsistent genotypes in the block
\item depth-ratio metrics (if add_ratios = TRUE)
}

If an error occurs during processing, a message is printed and \code{NULL} is returned.
}
\description{
This internal helper function runs the full UPD-calling pipeline for a single
chromosome. It applies the Viterbi algorithm to infer hidden states from trio
genotype observations, summarizes consecutive variants with identical inferred
states into blocks, counts Mendelian-inconsistent sites per block, and
optionally computes block-level read-depth ratios.
}
\keyword{internal}
